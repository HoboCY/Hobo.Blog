name: .NET Core CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
jobs:
  build:
    runs-on: centos-7.7
    steps:
    - uses: actions/checkout@v2
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 3.1.301
    - name: Docker Build & Push to Aliyun Repository
      uses: opspresso/action-docker@main
      with:
        args: --docker
      env:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}
        Repository: registry.cn-shanghai.aliyuncs.com/hobocy/blog
        dockerfile: "Dockerfile"
        image_name: "blog"
        tag_with_ref: true
